!function(){"use strict";const e=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.baseUrl=t,this.headers=s}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._handleRequest)}updateProfile(e,t){return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then(this._handleRequest)}updateAvatar(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._handleRequest)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._handleRequest)}addNewCard(e){return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify(e)}).then(this._handleRequest)}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._handleRequest)}addLike(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then(this._handleRequest)}removeLike(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then(this._handleRequest)}_handleRequest(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"25fa860b-0207-4525-82fb-69fc255d22d5","Content-Type":"application/json"}}),t=(document.querySelector(".cards__list"),document.querySelector("#edit-profile-modal"),document.querySelector("#delete-card-modal"),document.querySelector("#preview-image-modal")),s=document.querySelector("#edit-profile-form"),n=document.querySelector("#add-card-form"),r=document.querySelector("#edit-avatar-modal"),i=(document.querySelectorAll(".modal__close"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector(".avatar__image"),t.querySelector(".modal__image"),t.querySelector(".modal__description"),s.querySelector(".modal__input_type_name")),o=s.querySelector(".modal__input_type_description"),a=document.querySelector(".profile__edit-button"),l=document.querySelector(".avatar__edit-button"),d=document.querySelector(".profile__add-button"),c=(document.querySelector(".card__delete-button"),{formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"});class u{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}}var h=class extends u{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._submitButton=this._popupElement.querySelector(".modal__button"),this._buttonText=this._submitButton.textContent}_getInputValues(){const e=this._popupForm.querySelectorAll(".modal__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setButtonText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._buttonText}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}};class _{constructor(e,t,s,n,r){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=n,this._handleLikeClick=r}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick({link:this._link,name:this._name})}))}getIsLiked(){return this._isLiked}getId(){return this._id}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}handleLikeIcon(){console.log("changed isliked from",this._isLiked),this._isLiked=!this._isLiked,console.log("changed isliked to",this._isLiked),this._likeButton.classList.toggle("card__like-button_active")}getView(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);const e=this._cardElement.querySelector(".card__image"),t=this._cardElement.querySelector(".card__title");return e.src=this._link,e.alt=this._name,t.textContent=this._name,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active"),this._setEventListeners(),this._cardElement}}class m{constructor(e,t){this._settings=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}enableValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._formElement.addEventListener("submit",(e=>{e.preventDefault()}))}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_toggleButtonState(){this._hasInvalidInput()?this.disableSubmitButton():this._enableSubmitButton()}disableSubmitButton=()=>{this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.disabled=!0};_enableSubmitButton=()=>{this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1};_showInputError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}}const p=new m(c,r);p.enableValidation();const E=new m(c,s);E.enableValidation();const b=new m(c,n);function v(e){return new _(e,"#card-template",f,B,I).getView()}b.enableValidation();const S=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderItems(e){e.forEach((e=>this._renderer(e)))}}({renderer:e=>{S.addItem(v(e))}},".cards__list");function f(e){q.open(e)}e.getInitialCards().then((e=>{S.renderItems(e)})).catch((e=>{console.error("Error fetching initial cards:",e)}));const g=new h("#add-card-modal",(t=>{const s={name:t.title,link:t.link};g.setButtonText(!0),e.addNewCard(s).then((e=>{S.addItem(v(e)),b.disableSubmitButton(),n.reset(),g.close()})).catch((e=>{console.error("Error adding new card: ",e)})).finally((()=>{g.setButtonText()}))}));g.setEventListeners(),d.addEventListener("click",(()=>{g.open()})),e.getUserInfo().then((e=>{L.setUserInfo(e),L.setUserAvatar(e)})).catch((e=>{console.error("info not fetched from the server",e)}));const y=new h("#edit-profile-modal",(t=>{const s=t.name,n=t.description;y.setButtonText(!0),e.updateProfile(s,n).then((e=>{L.setUserInfo({name:e.name,about:e.about}),E.disableSubmitButton(),y.close()})).catch((e=>{console.error("info not updated",e)})).finally((()=>{y.setButtonText()}))})),L=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:n}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(n)}getUserInfo(){return{title:this._nameElement.textContent,description:this._jobElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._jobElement.textContent=s}setUserAvatar(e){let{avatar:t}=e;this._avatarElement.src=t}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".avatar__image"});y.setEventListeners(),a.addEventListener("click",(()=>{y.open();const e=L.getUserInfo();i.value=e.title,o.value=e.description,E.resetValidation()}));const k=new h("#edit-avatar-modal",(t=>{const s=t.avatar;s?(k.setButtonText(!0),e.updateAvatar(s).then((e=>{L.setUserAvatar(e),p.disableSubmitButton(),k.close()})).catch((e=>{console.error(e)})).finally((()=>{k.setButtonText()}))):console.error("URL missing")}));k.setEventListeners(),l.addEventListener("click",(()=>{k.open()}));const q=new class extends u{constructor(e){super(e),this._image=this._popupElement.querySelector(".modal__image"),this._caption=this._popupElement.querySelector(".modal__description")}open(e){let{link:t,name:s}=e;this._image.src=t,this._image.alt=s,this._caption.textContent=s,super.open()}}({popupSelector:"#preview-image-modal"});q.setEventListeners();const C=new class extends u{constructor(e){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button"),this._buttonText=this._submitButton.textContent}setSubmitAction(e){this._handleFormSubmit=e}setButtonText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Deleting...";this._submitButton.textContent=e?t:this._buttonText}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()})),super.setEventListeners()}}({popupSelector:"#delete-card-modal"});function B(t){C.open(),C.setSubmitAction((()=>{C.setButtonText(!0),e.deleteCard(t._id).then((()=>{t.handleDeleteCard(),C.close()})).catch((e=>{console.error("Error deleting card: ",e)})).finally((()=>{C.setButtonText()}))}))}function I(t){t.getIsLiked()?e.removeLike(t.getId()).then((()=>{t.handleLikeIcon()})).catch((e=>{console.error("Error removing like: ",e)})):e.addLike(t.getId()).then((()=>{t.handleLikeIcon()})).catch((e=>{console.error("Error adding like: ",e)}))}C.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UXdELE1BQU0sd0JBQXlCQSxFQUFNLElBRTlDTSxTQUFRLEtBQ1B3QixFQUFnQm5ILGVBQWUsR0FDL0IsR0FFUixDQUtBLFNBQVNZLEVBQWdCMEcsR0FFbEJBLEVBQUs3RixhQVdSNUcsRUFDRzBCLFdBQVcrSyxFQUFLNUYsU0FDaEJyRyxNQUFLLEtBQ0ppTSxFQUFLMUYsZ0JBQWdCLElBRXRCd0QsT0FBT0MsSUFDTnhELFFBQVF3RCxNQUFNLHdCQUF5QkEsRUFBTSxJQWhCakR4SyxFQUNHeUIsUUFBUWdMLEVBQUs1RixTQUNickcsTUFBSyxLQUNKaU0sRUFBSzFGLGdCQUFnQixJQUV0QndELE9BQU9DLElBQ054RCxRQUFRd0QsTUFBTSxzQkFBdUJBLEVBQU0sR0FhbkQsQ0EvQ0E4QixFQUFnQm5JLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICAvLyBHRVQtTE9BRCB0aGUgdXNlcidzIGluZm8gYW5kIGltZyBmcm9tIHRoZSBzZXJ2ZXJcclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcXVlc3QpO1xyXG4gIH1cclxuXHJcbiAgLy9QQVRDSC1FRElUIHRoZSBwcm9maWxlIGluZm9ybWF0aW9uIChVUERBVEUpXHJcbiAgdXBkYXRlUHJvZmlsZShuYW1lLCBhYm91dCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcXVlc3QpO1xyXG4gIH1cclxuXHJcbiAgLy9QQVRDSC1FRElUIHRoZSBhdmF0YXIgaW4gcHJvZmlsZSAoVVBEQVRFKVxyXG4gIHVwZGF0ZUF2YXRhcihhdmF0YXJVcmwpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogYXZhdGFyVXJsLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVxdWVzdCk7XHJcbiAgfVxyXG5cclxuICAvL0dFVC1MT0FEIHRoZSBpbml0aWFsIGNhcmQgZnJvbSB0aGUgc2VydmVyXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVxdWVzdCk7XHJcbiAgfVxyXG5cclxuICAvLyBQT1NULUFERCBhIG5ld0NhcmQgbmFtZS9saW5rIG9uIHRvIHRoZSBzZXJ2ZXIgdGhyb3VnaCBjcmVhdGVDYXJkKClcclxuICBhZGROZXdDYXJkKGNhcmREYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShjYXJkRGF0YSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXF1ZXN0KTtcclxuICB9XHJcblxyXG4gIC8vREVMRVRFIHRoZSBjYXJkXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcXVlc3QpO1xyXG4gIH1cclxuXHJcbiAgLy8gUFVUIGEgbGlrZSB0byBhIGNhcmRcclxuICBhZGRMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVxdWVzdCk7XHJcbiAgfVxyXG5cclxuICAvLyBERUxFVEUgYSBsaWtlIGZyb20gYSBjYXJkXHJcbiAgcmVtb3ZlTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcXVlc3QpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVJlcXVlc3QocmVzKSB7XHJcbiAgICByZXR1cm4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxufVxyXG5cclxuLy8gSW5pdGlhbGl6ZSB0aGUgQXBpIGNsYXNzXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjI1ZmE4NjBiLTAyMDctNDUyNS04MmZiLTY5ZmMyNTVkMjJkNVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5leHBvcnQgeyBhcGkgfTtcclxuIiwiZXhwb3J0IGNvbnN0IGNhcmRzV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgIEVsZW1lbnRzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIik7XHJcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZUZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtZm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci1tb2RhbFwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXZhdGFyX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IG1vZGFsSW1hZ2UgPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IGltYWdlRGVzY3JpcHRpb24gPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19kZXNjcmlwdGlvblwiXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gcHJvZmlsZUZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfbmFtZVwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBqb2JJbnB1dCA9IHByb2ZpbGVGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hdmF0YXJfX2VkaXQtYnV0dG9uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkRGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGhhbmRsZUZvcm1TdWJtaXQgPSAoZm9ybURhdGEpID0+IHtcclxuICBjb25zb2xlLmxvZyhmb3JtRGF0YSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIC8vb3BlbnMgcG9wdXBcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICAvL2Nsb3NlcyBwb3B1cFxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICAvL2xpc3RlbnMgZm9yIGVzYyBidXR0b25cclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9zZXRzIGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX2J1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dExpc3QgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcblxyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRCdXR0b25UZXh0KGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fYnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2ssXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9jYXJkX19saWtlLWJ1dHRvblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvL2NhcmRfX2RlbGV0ZS1idXR0b25cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vY2FyZCBpbWFnZVxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IGxpbms6IHRoaXMuX2xpbmssIG5hbWU6IHRoaXMuX25hbWUgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWQ7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVMaWtlSWNvbigpIHtcclxuICAgIGNvbnNvbGUubG9nKCdjaGFuZ2VkIGlzbGlrZWQgZnJvbScsIHRoaXMuX2lzTGlrZWQpO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9ICF0aGlzLl9pc0xpa2VkO1xyXG4gICAgY29uc29sZS5sb2coJ2NoYW5nZWQgaXNsaWtlZCB0bycsdGhpcy5faXNMaWtlZCk7XHJcblxyXG4gICAgdGhpcy5fbGlrZUJ1dHRvblxyXG4gICAgICAuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAvLyBzZXQgdGhlIGNhcmQgaW1hZ2UgYW5kIHRpdGxlXHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIGNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcblxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZGlzYWJsZVN1Ym1pdEJ1dHRvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9O1xyXG5cclxuICBfZW5hYmxlU3VibWl0QnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9O1xyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IHtcclxuICBjb25maWcsXHJcbiAgcHJvZmlsZUZvcm1FbGVtZW50LFxyXG4gIGFkZENhcmRGb3JtRWxlbWVudCxcclxuICBwcm9maWxlVGl0bGUsXHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIGF2YXRhckVkaXRCdXR0b24sXHJcbiAgYWRkTmV3Q2FyZEJ1dHRvbixcclxuICBuYW1lSW5wdXQsXHJcbiAgam9iSW5wdXQsXHJcbiAgYXZhdGFyRm9ybUVsZW1lbnQsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aERlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBhdmF0YXJGb3JtRWxlbWVudCk7XHJcbmVkaXRBdmF0YXJWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVGb3JtRWxlbWVudCk7XHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGFkZENhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGFkZENhcmRGb3JtRWxlbWVudCk7XHJcbmFkZENhcmRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgRnVuY3Rpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGl0ZW0sXHJcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApO1xyXG5cclxuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XHJcbn1cclxuXHJcbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgIGNhcmRMaXN0LmFkZEl0ZW0oY3JlYXRlQ2FyZChkYXRhKSk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4pO1xyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLz09PSBHRVQvTG9hZCB0aGUgY2FyZHMgZnJvbSB0aGUgc2VydmVyID09PVxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigoY2FyZHMpID0+IHtcclxuICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKGNhcmRzKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBpbml0aWFsIGNhcmRzOlwiLCBlcnJvcik7XHJcbiAgfSk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XHJcbiAgaW1hZ2VQb3B1cC5vcGVuKGNhcmREYXRhKTtcclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vPT09IFBPU1QgYSBuZXdDYXJkIG9uIHRvIHRoZSBzZXJ2ZXIgdXNpbmcgQ3JlYXRlQ2FyZCgpIGFib3ZlID09PVxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNhcmQtbW9kYWxcIiwgKGZvcm1EYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZERhdGEgPSB7IG5hbWU6IGZvcm1EYXRhW1widGl0bGVcIl0sIGxpbms6IGZvcm1EYXRhW1wibGlua1wiXSB9O1xyXG4gIG5ld0NhcmRQb3B1cC5zZXRCdXR0b25UZXh0KHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQoY2FyZERhdGEpXHJcbiAgICAudGhlbigoY3JlYXRlZENhcmQpID0+IHtcclxuICAgICAgY2FyZExpc3QuYWRkSXRlbShjcmVhdGVDYXJkKGNyZWF0ZWRDYXJkKSk7XHJcbiAgICAgIGFkZENhcmRWYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgICBhZGRDYXJkRm9ybUVsZW1lbnQucmVzZXQoKTtcclxuICAgICAgbmV3Q2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWRkaW5nIG5ldyBjYXJkOiBcIiwgZXJyb3IpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgbmV3Q2FyZFBvcHVwLnNldEJ1dHRvblRleHQoKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbm5ld0NhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG5ld0NhcmRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vPT09IEdldCBQcm9maWxlIFBvcHVwID09PVxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT1cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIodXNlckRhdGEpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihcImluZm8gbm90IGZldGNoZWQgZnJvbSB0aGUgc2VydmVyXCIsIGVycm9yKTtcclxuICB9KTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vPT09IEVkaXQgUHJvZmlsZSBQb3B1cCA9PT09XHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiLCAoZm9ybURhdGEpID0+IHtcclxuICBjb25zdCBuYW1lID0gZm9ybURhdGFbXCJuYW1lXCJdO1xyXG4gIGNvbnN0IGpvYiA9IGZvcm1EYXRhW1wiZGVzY3JpcHRpb25cIl07XHJcbiAgcHJvZmlsZVBvcHVwLnNldEJ1dHRvblRleHQodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlUHJvZmlsZShuYW1lLCBqb2IpXHJcbiAgICAudGhlbigodXBkYXRlZERhdGEpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICAgIG5hbWU6IHVwZGF0ZWREYXRhLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IHVwZGF0ZWREYXRhLmFib3V0LFxyXG4gICAgICB9KTtcclxuICAgICAgZWRpdEZvcm1WYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgICBwcm9maWxlUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJpbmZvIG5vdCB1cGRhdGVkXCIsIGVycm9yKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVQb3B1cC5zZXRCdXR0b25UZXh0KCk7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5hdmF0YXJfX2ltYWdlXCIsXHJcbn0pO1xyXG5cclxucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XHJcbiAgY29uc3QgY3VycmVudFVzZXJJbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBjdXJyZW50VXNlckluZm8udGl0bGU7XHJcbiAgam9iSW5wdXQudmFsdWUgPSBjdXJyZW50VXNlckluZm8uZGVzY3JpcHRpb247XHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vPT09IEVkaXQgQXZhdGFyIFBvcHVwID09PT09PVxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuY29uc3QgYXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNlZGl0LWF2YXRhci1tb2RhbFwiLCAoZm9ybURhdGEpID0+IHtcclxuICBjb25zdCBhdmF0YXJVcmwgPSBmb3JtRGF0YS5hdmF0YXI7XHJcblxyXG4gIGlmICghYXZhdGFyVXJsKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiVVJMIG1pc3NpbmdcIik7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGF2YXRhclBvcHVwLnNldEJ1dHRvblRleHQodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlQXZhdGFyKGF2YXRhclVybClcclxuICAgIC50aGVuKChhdmF0YXJEYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoYXZhdGFyRGF0YSk7XHJcbiAgICAgIGVkaXRBdmF0YXJWYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgICBhdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGF2YXRhclBvcHVwLnNldEJ1dHRvblRleHQoKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYXZhdGFyUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PVxyXG4vLz09PSBpbWFnZSBQb3B1cCA9PT09PT1cclxuLy89PT09PT09PT09PT09PT09PT09PT09XHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIixcclxufSk7XHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLz09PSBkZWxldGUgY2FyZCBQb3B1cCA9PT1cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhEZWxldGUoe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIsXHJcbn0pO1xyXG5cclxuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcclxuXHJcbiAgZGVsZXRlQ2FyZFBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XHJcbiAgICBkZWxldGVDYXJkUG9wdXAuc2V0QnV0dG9uVGV4dCh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGNhcmQ6IFwiLCBlcnJvcik7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAuc2V0QnV0dG9uVGV4dCgpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vPT09IHJlbW92ZUxpa2UvYWRkTGlrZSB0byBjYXJkID09PVxyXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcclxuICAvLyBpZiBjYXJkICFpc0xpa2VkIHJlbW92ZUxpa2VcclxuICBpZiAoIWNhcmQuZ2V0SXNMaWtlZCgpKSB7XHJcbiAgICBhcGlcclxuICAgICAgLmFkZExpa2UoY2FyZC5nZXRJZCgpKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBsaWtlOiBcIiwgZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICAgIC8vIGVsc2UgcmVtb3ZlTGlrZSB0byBjYXJkXHJcbiAgfSBlbHNlIHtcclxuICAgIGFwaVxyXG4gICAgICAucmVtb3ZlTGlrZShjYXJkLmdldElkKCkpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkLmhhbmRsZUxpa2VJY29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcmVtb3ZpbmcgbGlrZTogXCIsIGVycm9yKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGl0bGU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGVzY3JpcHRpb25cIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKHsgbGluaywgbmFtZSB9KSB7XHJcbiAgICAvL3NldCB0aGUgaW1hZ2UncyBzcmMgYW5kIGFsdFxyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICAvL3NldCB0aGUgY2FwdGlvbidzIHRleHRDb250ZW50XHJcbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9idXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHNldEJ1dHRvblRleHQoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiRGVsZXRpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2J1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aERlbGV0ZTtcclxuIl0sIm5hbWVzIjpbImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwiX2hhbmRsZVJlcXVlc3QiLCJ1cGRhdGVQcm9maWxlIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXJVcmwiLCJhdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJhZGROZXdDYXJkIiwiY2FyZERhdGEiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiYXV0aG9yaXphdGlvbiIsInByZXZpZXdJbWFnZU1vZGFsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicHJvZmlsZUZvcm1FbGVtZW50IiwiYWRkQ2FyZEZvcm1FbGVtZW50IiwiYXZhdGFyRm9ybUVsZW1lbnQiLCJuYW1lSW5wdXQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiam9iSW5wdXQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsImF2YXRhckVkaXRCdXR0b24iLCJhZGROZXdDYXJkQnV0dG9uIiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2UiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9zdWJtaXRCdXR0b24iLCJfYnV0dG9uVGV4dCIsInRleHRDb250ZW50IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRMaXN0IiwiZm9ybVZhbHVlcyIsImZvckVhY2giLCJpbnB1dCIsInZhbHVlIiwic2V0QnV0dG9uVGV4dCIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsIl9uYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkRWxlbWVudCIsImdldElzTGlrZWQiLCJnZXRJZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlSWNvbiIsImNvbnNvbGUiLCJsb2ciLCJfbGlrZUJ1dHRvbiIsInRvZ2dsZSIsImdldFZpZXciLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZEltYWdlIiwiY2FyZFRpdGxlIiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwiZW5hYmxlVmFsaWRhdGlvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0RWxlbWVudCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJldmVudCIsInJlc2V0VmFsaWRhdGlvbiIsIl9oaWRlSW5wdXRFcnJvciIsInZhbGlkaXR5IiwidmFsaWQiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlU3VibWl0QnV0dG9uIiwiX2VuYWJsZVN1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJzb21lIiwiZWRpdEF2YXRhclZhbGlkYXRvciIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZFZhbGlkYXRvciIsImNyZWF0ZUNhcmQiLCJpdGVtIiwiY2FyZExpc3QiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpbWFnZVBvcHVwIiwiY2FyZHMiLCJjYXRjaCIsImVycm9yIiwibmV3Q2FyZFBvcHVwIiwiUG9wdXBXaXRoRm9ybSIsImZvcm1EYXRhIiwiY3JlYXRlZENhcmQiLCJyZXNldCIsImZpbmFsbHkiLCJ1c2VyRGF0YSIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwicHJvZmlsZVBvcHVwIiwiam9iIiwidXBkYXRlZERhdGEiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJfcmVmMiIsIl9yZWYzIiwiY3VycmVudFVzZXJJbmZvIiwiYXZhdGFyUG9wdXAiLCJhdmF0YXJEYXRhIiwiZXJyIiwiX2ltYWdlIiwiX2NhcHRpb24iLCJkZWxldGVDYXJkUG9wdXAiLCJzZXRTdWJtaXRBY3Rpb24iLCJhY3Rpb24iLCJjYXJkIl0sInNvdXJjZVJvb3QiOiIifQ==